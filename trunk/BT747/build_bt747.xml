<!-- ****** GENERATED BY SUPERWABA-IDE - DO NOT MODIFY!!! ****** -->
<project name="BT747" basedir="." default="all">

	<!-- Application classpath -->
	<path id="classpath">
		<pathelement location="c:\SuperWabaSDK/lib/SuperWaba.jar"/>
		<pathelement location="\BT747\win32comm.jar"/>
	</path>
	
	<!-- Warp/Exegen classpath -->
	<path id="utils">
		<pathelement location="c:\SuperWabaSDK/lib/SuperWabaTools.jar"/>
		<pathelement location="c:\SuperWabaSDK/lib/SuperWaba.jar"/>
	</path>
	
	<!-- Clean directories and files -->
	<target name="clean">
	
		<delete dir="build"/>
		<delete dir="dist"/>
		
	</target>
	
	<!-- Update date -->
    <property name="encoding" value="UTF-8"/>
    <target name="initdate">
  		<tstamp>
    		<format property="DATE" pattern="yyyyMMdd"/>
    		<format property="DATE_DE" pattern="dd.MM.yyyy"/>
    		<format property="DATE_UND" pattern="dd_MM_yyyy"/>
    		<format property="DATE_TIME" pattern="yyyyMMdd_HHmmss"/>
    		<format property="DATETIME_DE" pattern="dd.MM.yyyy HH:mm:ss"/>
    		<format property="TIMESTAMP" pattern="yyyyMMddHHmmssSSS"/>
    	</tstamp>
    	
    	<echo level="info">
	        Project: ${ant.project.name} (${basedir})
	    	Build file: ${ant.file}
	        Java: ${java.version} ${java.vendor}
	        OS: ${os.name} ${os.version} ${os.arch}
	       	${ant.version} (Java: ${ant.java.version})
	       	Time: ${DATETIME_DE}
    	</echo>
    </target>
 
    <target name="updatedate" depends="initdate" description="increase build number and set release date">
        <!-- required lib: Jakarta ORO for optional task <replaceregexp> -->
    	<replaceregexp file="src/Version.java" encoding="${encoding}" match="BUILD = [0-9]+L;" replace="BUILD = ${TIMESTAMP}L;"/>
    	<replaceregexp file="src/Version.java" encoding="${encoding}" match="DATE = [^a]*;" replace='DATE = "${DATE_DE}";'/>	
    	<replaceregexp file="package.bat" encoding="${encoding}" match="SET DT=[^\n]*" replace='SET DT=${DATE_TIME}'/>	
    </target>
    	
	<!-- Compile -->
	<target name="build" depends="clean, updatedate">
	
		<mkdir dir="build"/>
		<mkdir dir="dist"/>
		
		<javac srcdir="c:\mdeweerd\workspace\BT747\src" destdir="build" target="1.1" optimize="true">
			<include name="**/*.java"/>
			<exclude name="gps/model/*"/>
			<classpath refid="classpath"/>
		</javac>
		<copy todir="build">
			<fileset dir="c:\mdeweerd\workspace\BT747\src">
				<exclude name="**/*.java"/>
			</fileset>
		</copy>
	
	</target>
	
	<!-- Package classes -->
	<target name="jar" depends="build">
	
		<jar jarfile="build/${ant.project.name}.jar">
			<fileset dir="build" includes="**/*.class"/>
		</jar>
	
	</target>

	<target name="smalljar" depends="build">
		<jar jarfile="build/${ant.project.name}_small.jar">
			<fileset dir="build" includes="**/*.class" />
		</jar>
	
	</target>
	
	<!-- Execute WARP -->
	<target name="warp" depends="jar">
	
		<java dir="build" classname="superwaba.tools.Warp" fork="true" classpathref="utils">
			<arg value="c"/>
			<arg value="/c"/>
			<arg value="BT74"/>
			<arg value="${ant.project.name}"/>
			<arg value="${ant.project.name}.jar"/>
		</java>
	
	</target>
	
	<!-- Prepare EXEGEN execution -->
	<target name="prepare-exegen">
		
		<mkdir dir="icons"/>
		<copy todir="build">
			<fileset dir="icons">
				<include name="*.bmp"/>
			</fileset>
		</copy>
	
	</target>
	
	<!-- Execute EXEGEN -->
	<target name="exegen" depends="warp, prepare-exegen">
	
		<java dir="build" classname="superwaba.tools.Exegen" fork="true" classpathref="utils">
			<arg value="/c"/>
			<arg value="BT74"/>
			<arg value="${ant.project.name}"/>
			<arg value=""/>
			<arg value="${ant.project.name}"/>
		</java>
	
	</target>
	
	<!-- Execute EXEGEN with WinCE EXE -->
	<target name="exegen-exe" depends="warp, prepare-exegen">
	
		<java dir="build" classname="superwaba.tools.Exegen" fork="true" classpathref="utils">
			<arg value="/c"/>
			<arg value="BT74"/>
			<arg value="/e"/>
			<arg value="${ant.project.name}"/>
			<arg value=""/>
			<arg value="${ant.project.name}"/>
		</java>
	
	</target>
	
	<!-- Execute EXEGEN with WinCE CAB -->
	<target name="exegen-cab" depends="warp, prepare-exegen">
	
		<java dir="build" classname="superwaba.tools.Exegen" fork="true" classpathref="utils">
			<arg value="/c"/>
			<arg value="BT74"/>
			<arg value="/z"/>
			<arg value="${ant.project.name}"/>
			<arg value=""/>
			<arg value="${ant.project.name}"/>
		</java>
	
	</target>
	
	<!-- Execute WARP and populate distribution directory -->
	<target name="all-warp" depends="warp">
		
		<move file="build/${ant.project.name}.pdb" todir="dist"/>
		
	</target>
	
	<!-- Execute EXEGEN and populate distribution directory -->
	<target name="all-exegen" depends="exegen, all-warp">
		
		<move todir="dist" file="build/${ant.project.name}.prc"/>
		
	</target>
	
	<!-- Execute EXEGEN with WinCE EXE and populate distribution directory -->
	<target name="all-exegen-exe" depends="exegen-exe, all-warp">
		
		<move todir="dist">
			
			<fileset dir="build">
				<include name="${ant.project.name}.prc"/>
				<include name="**/*.exe"/>
			</fileset>
			
		</move>
		
	</target>
	
	<!-- Execute EXEGEN with WinCE CAB and populate distribution directory -->
	<target name="all-exegen-cab" depends="exegen-cab, all-warp">
		
		<move todir="dist">
			
			<fileset dir="build">
				<include name="${ant.project.name}.prc"/>
				<include name="*.CAB"/>
				<include name="*.ini"/>
				<include name="*.bat"/>
			</fileset>
			
		</move>
		
	</target>
	
	<target name="all" depends="all-exegen-cab"/>

</project>
